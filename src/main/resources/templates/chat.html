<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon.png">
  <link rel="icon" type="image/png" href="/images/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <!-- CSS Files -->
  <link href="/css/material-kit.css?v=2.0.7" rel="stylesheet" />
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="/css/zzin.css" rel="stylesheet" />
  
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<!-- 합쳐지고 최소화된 최신 CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<!-- 부가적인 테마 -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="/css/zzin.css">
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
	integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4"
	crossorigin="anonymous">
<title>Talk-to-Talk_chat</title>

<style>
.image_box {
	width: 35%;
	height: 100%;
	overflow: hidden;
	display: flex;
	align-items: center;
	justify-content: center;
}
.image_box img {
  width: 100%;
  border:5px solid #fff;
  box-shadow:0 0 3px rgba(0, 0, 0, .25);
  float:left;
  margin-right:30px;
  width:90%;
  transition:all .3s ease-in-out;
}
.middle_wrap {
	width: 90%;
	height: 500px;
	display: flex;
}
.attrHorizontal {
	display: flex;
	font-size: 2em;
	margin-left: 10%;
}

</style>
</head>

<body style="background: linear-gradient(55deg, RGB(107,115,178) 0%, RGB(160,177,221) 51%, RGB(242,132,227) 85%);">
  <nav class="navbar navbar-transparent fixed-top navbar-expand-lg bg-dark">
    <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-translate">
	  	<a href="/"><img src="/images/logo/logo.png" alt="Circle Image" style="width:10%;"></a>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ml-auto">
          <li class="dropdown nav-item">
            <a href="javascript:;" class="profile-photo dropdown-toggle nav-link" data-toggle="dropdown">
	            <div class="profile-photo-small" sec:authorize="isAuthenticated()">
	               <img id="circleimg" style="width:40px;height:40px;border-radius: 100%;display: inline-block;vertical-align: middle;
	               object-fit: cover;" alt="Circle Image" class="rounded-circle img-fluid">
	            </div>
            </a>
            <div class="dropdown-menu dropdown-menu-right">
              <h6 class="dropdown-header">Dropdown header</h6>
              <a href="javascript:;" class="mypage dropdown-item">💁 내정보</a>
              <a href="/chat" class="dropdown-item">💬 채팅방</a>
              <a href="/logout" class="dropdown-item">👋 로그아웃</a>
            </div>
          </li>
          <li class="nav-item">
            <a href="javascript:;" class="profile-photo nav-link" th:href="@{/account/regist}" sec:authorize="!isAuthenticated()">
              <div class="profile-photo-small">
              	<img src="/images/logo/regist_black.png" alt="로그인이 필요합니다." class="img-fluid">
              </div>
            </a>
            <a href="javascript:;" th:href="@{/mypage}" sec:authorize="isAuthenticated()">
              <span id='nickname' class='mypage' th:text="${session.nickname}" style="color:black;">사용자</span>
            </a>
              <span id='username' th:text="${session.username}" style="display:none;">사용자</span>
          </li>
          <li class="nav-item">
            <a href="javascript:;" class="profile-photo nav-link" th:href="@{/account/login}" sec:authorize="!isAuthenticated()">
              <div class="profile-photo-small">
                <img src="/images/logo/off_black.png" alt="Circle Image" class="img-fluid">
              </div>
            </a>
            <a href="javascript:;" class="profile-photo nav-link" th:href="@{/logout}" sec:authorize="isAuthenticated()">
              <div class="profile-photo-small">
                <img src="/images/logo/on_black.png" alt="Circle Image" class="img-fluid">
              </div>
            </a>
          </li>
        </ul>
      </div><!-- /.navbar-collapse -->
    </div><!-- /.container-->
  </nav>
	
	<br><br><br><br>
	<div>
		<input class="hidden" id="hey" value="${user.username}">
			<div id="room-page">
				<div class="chat-container">
					<div class="chat-header">
						<h1 style="text-align:center;">채팅방 목록<button id="createRoomButton"></button></h1>
					</div>
					<div class="room-page-bar">
						<div class="room-page-bar-no">방번호</div>
						<div class="room-page-bar-title">방제목</div>
						<div class="room-page-bar-people">현재인원/최대인원</div>
					</div>
					<ul id="listRoom" class="list-group">

					</ul>
					<form action="/chat/search" id="searchForm" method="get">
	                  	<div class="form-group">
	                     <div class="input-group clearfix">
	                        <input type="text" id="search" name="search" placeholder="검색하기" autocomplete="off" class="form-control" />
							<input type="image" src="/images/logo/search.png" style="width:6%; margin:1%; margin-top:0%; padding:0;">
	                     </div>
	                  	</div>
               		</form>
				</div>
			</div>
			<div id="roommk-page" class="hidden">
				<div class="chat-container">
					<div class="chat-header">
						<h1 style="text-align:center;">채팅방 개설<button id="roommkoutButton"></button></h1>
					</div><br><br><br>
					<div>
						<div class="col-sm">
							<div class="form-field">
								<div><b>방&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp제:</b>
									<input class="popup-button-input" id="createRoomName" type="text" placeholder="방제를 입력하세요" />
								</div>
							</div>
						</div>
						<div class="col-sm">
							<div class="form-field">
									<div><b>최대인원:</b>
										<select class="popup-button-input" id="maxpp" name="maxpp">
											<option value="2">2</option>
											<option value="3">3</option>
											<option value="4" selected="selected">4</option>
											<option value="6">6</option>
											<option value="10">10</option>
										</select>
									</div>
							</div>
						</div><br>
						<div class="popup-button">
							<form id="createRoomForm" name="createRoomForm">
								<div class="form-group">
									<div class="input-group clearfix">
										<button type="submit" class="popup-button-bt" id="createRoom">방 개설</button> &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
										<a href="/" onclick="javascript:window.close()"><button class="popup-button-bt" type="submit">나가기</button></a>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
			<div id="chat-page" class="hidden">
				<div class="chat-container">
					<div class="chat-header">
						<h2>채팅방 [<span id="room-id-display"></span>]
						<button id="chatoutButton"></button></h2>
					</div>
					<h2 class="noticeArea" id="noticeArea" name="noticeArea" th:text="${session.notice}">공지사항</h2>
					<div class="connecting">연결중...</div>
					<ul id="messageArea">

					</ul>
					<form id="messageForm" name="messageForm" nameForm="messageForm">
						<div class="form-group">
							<div class="input-group clearfix">
									<input type="text" id="message" placeholder="/leave -방을 떠나기   /notice -공지 남기기 "
										autocomplete="off" class="form-control col-lg-10"/>
								<input type="image" src="/images/logo/send.png" style="width:6%; margin:0%; margin-left:1%; padding:0;">
								<input type="image" id="EmojiButton" src="/images/emoji/dance.png" style="width:6%; margin:0%; margin-left:1%; padding:0;">
								<div id="EmojiBox" class="hidden">
									<div type="button" class="modal_close" for="open-pop"></div>
									<h2> 이모티콘 </h2>
									<button class="Emoji" value="ahaha" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/ahaha.png" style="width:50%;"></button>
									<button class="Emoji" value="cheers" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/cheers.png" style="width:50%;"></button>
									<button class="Emoji" value="crying" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/crying.png" style="width:50%;"></button>
									<button class="Emoji" value="curious" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/curious.png" style="width:50%;"></button>
									<button class="Emoji" value="cute" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/cute.png" style="width:50%;"></button>
									<button class="Emoji" value="dance" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/dance.png" style="width:50%;"></button>
									<button class="Emoji" value="despair" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/despair.png" style="width:50%;"></button>
									<button class="Emoji" value="fart" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/fart.png" style="width:50%;"></button>
									<button class="Emoji" value="full" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/full.png" style="width:50%;"></button>
									<button class="Emoji" value="glance" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/glance.png" style="width:50%;"></button>
									<button class="Emoji" value="gross" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/gross.png" style="width:50%;"></button>
									<button class="Emoji" value="guard" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/guard.png" style="width:50%;"></button>
									<button class="Emoji" value="knockdown" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/knockdown.png" style="width:50%;"></button>
									<button class="Emoji" value="lookingforward" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/lookingforward.png" style="width:50%;"></button>
									<button class="Emoji" value="love" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/love.png" style="width:50%;"></button>
									<button class="Emoji" value="mad" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/mad.png" style="width:50%;"></button>
									<button class="Emoji" value="mask" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/mask.png" style="width:50%;"></button>
									<button class="Emoji" value="mermaid" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/mermaid.png" style="width:50%;"></button>
									<button class="Emoji" value="normal" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/normal.png" style="width:50%;"></button>
									<button class="Emoji" value="omg" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/omg.png" style="width:50%;"></button>
									<button class="Emoji" value="shining" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/shining.png" style="width:50%;"></button>
									<button class="Emoji" value="sleeping" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/sleeping.png" style="width:50%;"></button>
									<button class="Emoji" value="smile" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/smile.png" style="width:50%;"></button>
									<button class="Emoji" value="sneak" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/sneak.png" style="width:50%;"></button>
									<button class="Emoji" value="sullen" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/sullen.png" style="width:50%;"></button>
									<button class="Emoji" value="swag" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/swag.png" style="width:50%;"></button>
									<button class="Emoji" value="thumb" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/thumb.png" style="width:50%;"></button>
									<button class="Emoji" value="touchhorn" style="padding:0;margin:0;height:20%;background:white;"><img src="/images/emoji/touchhorn.png" style="width:50%;"></button>
									<button class="Emoji" value="vomit" style="padding:0;margin:0;height:20%;background:white;background:white;"><img src="/images/emoji/vomit.png" style="width:50%;"></button>
								</div>
							</div>
						</div>
					</form>
				</div>
			</div>
			<div id="info-page" class="hidden">
				<div class="chat-container" style="display: flex;flex-direction: column;
				align-content: space-around;">
					<div class="chat-header">
						<h2>[<span id="userinfo_nickname" style="font-size: 3em; font-weight: bold;">error</span>]님의 프로필
						<button id="profileoutButton">뒤로가기</button></h2>
					</div>
					<div style="display: flex;align-items: center;justify-content: center;">
						<table>
							<tr>
								<td><img id="userinfo_pic" src=></td>
							</tr>
							<tr>
								<td><b>성별</b></td>
								<td>
								<span id="userinfo_sex">gender</span>
								</td>
							</tr>
							<tr>
								<td><b>지역</b></td>
								<td>
								<span id="userinfo_city">city</span>
								</td>
							</tr>
							<tr>
								<td><b>생년월일</b></td>
								<td>
								<span id="userinfo_birthday">birthday</span>
								</td>
							</tr>
							<tr>
								<td><b>상태메시지</b></td>
								<td>
								<span id="userinfo_bio">bio</span>
								</td>
							</tr>
						</table>
					</div>
				</div>
			</div>
	</div>
	
	<script src="http://code.jquery.com/jquery-3.3.1.min.js"
		integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
		crossorigin="anonymous"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.0/js.cookie.min.js"></script>
	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.4.0/sockjs.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
	<script
		src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
	<script src="/js/main.js"></script>
	<script>
    $(document).ready(function() {
		$.ajax({
		    type: "POST",
		    url: "/homegetinfo",
		    data: {
		    	username: document.getElementById('username').innerHTML,
		    	nickname: document.getElementById('nickname').innerHTML
		    },
		    success: function (data) {	
				$("#circleimg").attr("src",data.pic);
		    },
			error : function(err) {
				alert("homegetinfo실패");
			}
		})
    });
	 $('.mypage').click(function () {
			$.ajax({
			    type: "GET",
			    url: "/mypaging",
			    data: {
			    	username: document.getElementById('username').innerHTML,
			    	nickname: document.getElementById('nickname').innerHTML
			    },
			    success: function (data) {	
			    	location.href='/mypage';
			    }
			})
		});
	</script>
</body>
</html>